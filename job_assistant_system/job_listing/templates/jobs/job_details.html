{% extends 'core/layout.html' %}

{% block content %}
<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card mb-4">
            <div class="card-body">
                <h2 class="card-title">{{ job.title }}</h2>
                <h4 class="card-subtitle mb-3 text-muted">{{ job.company.display_name }}</h4>

                <div class="mb-3">
                    <span class="badge bg-primary">{{ job.contract_type | default:"Full-time" }}</span>
                    <span class="badge bg-secondary ms-2">{{ job.location.display_name | default:"Remote" }}</span>
                    <span class="badge bg-success ms-2">${{ job.salary_min | default:"N/A" }} - ${{ job.salary_max |
                        default:"N/A" }}</span>
                </div>

                <div class="mb-4">
                    <h5>Description</h5>
                    <p>{{ job.description | safe }}</p>
                </div>

                <div class="mb-4">
                    <h5>Requirements</h5>
                    <p>{{ job.requirements | default:"Not specified" | safe }}</p>
                </div>

                <div class="d-flex justify-content-between align-items-center">
                    <small class="text-muted">Posted: {{ job.created | date:"M d, Y" }}</small>
                    <a href="{{ job.redirect_url }}" target="_blank" class="btn btn-primary">Apply on Company Site</a>
                </div>
            </div>
        </div>

        {% if user.is_authenticated %}
        <div class="card">
            <div class="card-body">
                {% if already_applied %}
                <div class="alert alert-success">
                    You've already applied to this position!
                </div>
                <a href="{% url 'jobs:my_applications' %}" class="btn btn-outline-primary">View Your Applications</a>
                {% else %}
                <h5 class="card-title">Track This Application</h5>
                <p class="card-text">Save this job to track your application status.</p>
                <form method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit" class="btn btn-primary">Save Application</button>
                </form>
                {% endif %}
            </div>
        </div>
        {% else %}
        <div class="alert alert-info">
            <a href="{% url 'login' %}?next={% url 'jobs:job_detail' job.id %}" class="alert-link">Login</a> to track
            your application.
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}